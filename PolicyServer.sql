USE [master]
GO
/****** Object:  Database [PolicyServer2]    Script Date: 07-06-2014 23:56:25 ******/
CREATE DATABASE [PolicyServer2]
GO
ALTER DATABASE [PolicyServer2] SET COMPATIBILITY_LEVEL = 110
GO
IF (1 = FULLTEXTSERVICEPROPERTY('IsFullTextInstalled'))
begin
EXEC [PolicyServer2].[dbo].[sp_fulltext_database] @action = 'enable'
end
GO
ALTER DATABASE [PolicyServer2] SET ANSI_NULL_DEFAULT OFF 
GO
ALTER DATABASE [PolicyServer2] SET ANSI_NULLS OFF 
GO
ALTER DATABASE [PolicyServer2] SET ANSI_PADDING OFF 
GO
ALTER DATABASE [PolicyServer2] SET ANSI_WARNINGS OFF 
GO
ALTER DATABASE [PolicyServer2] SET ARITHABORT OFF 
GO
ALTER DATABASE [PolicyServer2] SET AUTO_CLOSE OFF 
GO
ALTER DATABASE [PolicyServer2] SET AUTO_CREATE_STATISTICS ON 
GO
ALTER DATABASE [PolicyServer2] SET AUTO_SHRINK OFF 
GO
ALTER DATABASE [PolicyServer2] SET AUTO_UPDATE_STATISTICS ON 
GO
ALTER DATABASE [PolicyServer2] SET CURSOR_CLOSE_ON_COMMIT OFF 
GO
ALTER DATABASE [PolicyServer2] SET CURSOR_DEFAULT  GLOBAL 
GO
ALTER DATABASE [PolicyServer2] SET CONCAT_NULL_YIELDS_NULL OFF 
GO
ALTER DATABASE [PolicyServer2] SET NUMERIC_ROUNDABORT OFF 
GO
ALTER DATABASE [PolicyServer2] SET QUOTED_IDENTIFIER OFF 
GO
ALTER DATABASE [PolicyServer2] SET RECURSIVE_TRIGGERS OFF 
GO
ALTER DATABASE [PolicyServer2] SET  ENABLE_BROKER 
GO
ALTER DATABASE [PolicyServer2] SET AUTO_UPDATE_STATISTICS_ASYNC OFF 
GO
ALTER DATABASE [PolicyServer2] SET DATE_CORRELATION_OPTIMIZATION OFF 
GO
ALTER DATABASE [PolicyServer2] SET TRUSTWORTHY OFF 
GO
ALTER DATABASE [PolicyServer2] SET ALLOW_SNAPSHOT_ISOLATION OFF 
GO
ALTER DATABASE [PolicyServer2] SET PARAMETERIZATION SIMPLE 
GO
ALTER DATABASE [PolicyServer2] SET READ_COMMITTED_SNAPSHOT OFF 
GO
ALTER DATABASE [PolicyServer2] SET HONOR_BROKER_PRIORITY OFF 
GO
ALTER DATABASE [PolicyServer2] SET RECOVERY FULL 
GO
ALTER DATABASE [PolicyServer2] SET  MULTI_USER 
GO
ALTER DATABASE [PolicyServer2] SET PAGE_VERIFY CHECKSUM  
GO
ALTER DATABASE [PolicyServer2] SET DB_CHAINING OFF 
GO
ALTER DATABASE [PolicyServer2] SET FILESTREAM( NON_TRANSACTED_ACCESS = OFF ) 
GO
ALTER DATABASE [PolicyServer2] SET TARGET_RECOVERY_TIME = 0 SECONDS 
GO
ALTER DATABASE [PolicyServer2] SET TRUSTWORTHY ON
GO
EXEC sys.sp_db_vardecimal_storage_format N'PolicyServer2', N'ON'
GO
USE [PolicyServer2]
GO
/****** Object:  SqlAssembly [PolicyWatcher]    Script Date: 07-06-2014 23:56:25 ******/
CREATE ASSEMBLY [PolicyWatcher]
FROM 0x4D5A90000300000004000000FFFF0000B800000000000000400000000000000000000000000000000000000000000000000000000000000000000000800000000E1FBA0E00B409CD21B8014CCD21546869732070726F6772616D2063616E6E6F742062652072756E20696E20444F53206D6F64652E0D0D0A2400000000000000504500004C010300562C72530000000000000000E00002210B010B000018000000060000000000008E3700000020000000400000000040000020000000020000040000000000000004000000000000000080000000020000000000000300408500001000001000000000100000100000000000001000000000000000000000003C3700004F000000004000002803000000000000000000000000000000000000006000000C000000803600001C0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000200000080000000000000000000000082000004800000000000000000000002E7465787400000094170000002000000018000000020000000000000000000000000000200000602E72737263000000280300000040000000040000001A0000000000000000000000000000400000402E72656C6F6300000C0000000060000000020000001E0000000000000000000000000000400000420000000000000000000000000000000070370000000000004800000002000500E0250000A010000001000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000001E02281000000A2A1E02185D16FE012A56027B0700000403186F1200000A1F10281300000A2A1E02185D16FE012A56027B0800000403186F1200000A1F10281300000A2A133005008902000001000011730D0000061312026F1400000A0A0373090000060B076F0A0000060C72010000700D0813131613142B251113111491130409722B00007011048C1C000001281500000A281600000A0D111417581314111411138E6932D3731700000A13051105097239000070281600000A6F1800000A13060611061611068E696F1900000A066F1A00000A20800000008D1C000001130720800000008D1C00000113080611071611078E696F1B00000A260611081611088E696F1B00000A261112281C00000A11071611078E696F1D00000A7D070000041112281C00000A11081611088E696F1D00000A7D080000041611127B070000046F1E00000A281F00000A7E010000042D1114FE0603000006732000000A80010000047E01000004280100002B1112FE060E000006732200000A280200002B280300002B13091611127B080000046F1E00000A281F00000A7E020000042D1114FE0604000006732000000A80020000047E02000004280100002B1112FE060F000006732200000A280200002B280300002B130A071109110A6F0C0000062D231105723D0000706F1800000A130B06110B16110B8E696F1900000A066F1A00000A162A0711096F0B000006130C110C2D231105723D0000706F1800000A130D06110D16110D8E696F1900000A066F1A00000A162A7247000070130E110C13151613162B271115111691130F110E722B000070110F8C1C000001281500000A281600000A130E111617581316111611158E6932D11105110E7239000070281600000A6F1800000A13060611061611068E696F1900000A066F1A00000A7E2500000A13112B1111111110D18C22000001282600000A1311066F2700000A251310152E071110D11F2E33DC111172810000706F2800000A2C02162A172A1E02281000000A2A0000001B3004005800000002000011022C54022C51732900000A0A0602036F2A00000A067E0300000428010000062C25040B066F1400000A0C731700000A0D09076F1800000A13040811041611048E696F1900000ADE0A062C06066F2B00000ADCDE0326DE002A011C000002000C003C48000A00000000000006004E54000324000001133002006800000003000011052D02172A051A5F2C5A042C55046F2C00000A2C4D046F2C00000A0C160D2B3C08098F2500000171250000010A036F2D00000A036F2E00000A282F00000A2C0B1200283000000A1F202E0D1200283000000A2C04160BDE0E0917580D09088E6932BE172A162A072A56733100000A72890000706F1800000A80030000042A1E02281000000A2A000003300300560000000000000002281000000A02283200000A7D04000004021F408D1C0000017D05000004027B04000004027B050000046F3300000A027B050000041F3F8F1C00000125711C00000120FE0000005FD2811C00000102037D060000042A1E027B050000042A0000133005008600000004000011038E691F402E02142A031F3F91175F2D02142A027B050000048E69038E6958027B060000048E69588D1C0000010A027B05000004160616027B050000048E69283400000A031606027B050000048E69038E69283400000A027B060000041606027B050000048E69038E6958027B060000048E69283400000A733500000A0B07066F3600000A2A0000133005008900000005000011038E691F402E02162A031F3F91175F2D02162A038E69027B050000048E6958027B060000048E69588D1C0000010A03160616038E69283400000A027B050000041606038E69027B050000048E69283400000A027B060000041606038E69027B050000048E6958027B060000048E69283400000A733500000A0B07066F3600000A0C0804280400002B2A00000042534A4201000100000000000C00000076322E302E35303732370000000005006C00000038050000237E0000A40500003007000023537472696E677300000000D40C00005401000023555300280E0000100000002347554944000000380E00006802000023426C6F62000000000000000200000157150208090A000000FA253300160000010000002B00000005000000080000000F00000011000000370000001200000005000000020000000100000003000000010000000400000000000A00010000000000060066005F000A0080006D000600E400B6000A00F400B6000A001201FE00060059013C0106002E021C02060045021C02060062021C02060081021C0206009A021C020600B3021C020600CE021C020600E9021C02060021030203060035030203060043031C0206005C031C0206008C0379034F00A00300000600CF03AF030600EF03AF030E008C045F000600BA04AF0306000F055F00060020055F000A002F056D00060047055F00060066055A05060074055A050600900586050E00D205C6050600F805DD05060027065F00060046065F0006005A065F000A006406B6000A00A706B6000600CE065A050600E2065F000600E9065F000600F9063C01060007073C010000000001000000000001000100000010001C0030000500010001000100100030003000050003000500000010003E003000050004000900030110000D040000050007000D00110093046C001100E8046C0011009D00160001006F012C00010076011600010084011600060020045F00060033045F0094200000000096008A000A000100292300000000861897001200030058200000000091006D04670003007620000000009100D504670004003423000000009600AA001A000500B4230000000096002201210008003E24000000008618970012000C002824000000009118C70693010C004824000000008618970030000C00AA240000000086008B0136000D00B4240000000086009C013B000D0048250000000086008A0042000E00502000000000861897001200100060200000000086004504620010007E2000000000860058046200110000000100A80100000200AF01000001006B04000001006B0400000100B80100000200C10100000300CC0100000100D40100000200DB0100000300E70100000400ED0100000100840100000100FD0100000100FD01000002000D02000001006B04000001006B04390097004A00410097004A00490097004A00510097004A00590097004A00610097004A00690097004A00710097004A00790097004F00810097004A00890097004A00910097004A00990097005400A90097005A00B10097001200090097001200C10097001200C90016057900D10028057F0011003D058500C9004C058A00C90053059000E90097001200F1007D059600F90097059C00F9009D051200F900A305A400F100A805AC00F100B105B100C900BB05B90001010606BD000C009700CF0001010C06D50014009700CF0001011206F900010119061801C90021065F00C90053052A01F9002C06B900C9003506300111009700120011003E065E01190152061200210074067001190084067701190090067701C9009B067B012901BC0681013901970012003100DB06970131007D0530004101EF069C01510197001200590115073B0001012107B10121008B0074002E002300E1012E002B00CE012E003300E7012E0073003F022E000B00CE012E001300E1012E001B00E1012E004B00E1012E006B0036022E003B00E1012E007B0048022E005300FF012E006300290241008B00740060008B00740080008B007400A3008B007400350164018701A901C401C800F20004800000010000000000000000000000000030000000020000000000000000000000010056000000000002000000000000000000000001005F00000000000300050000000000000000000100800400000000050002004300EE0047001301490026016F00260100000000003C4D6F64756C653E00506F6C696379576174636865722E646C6C0044616361435241757468656E74696361746F7200506F6C69637957617463686572004D757475616C4368616C6C656E6765526573706F6E7365006D73636F726C69620053797374656D004F626A6563740053797374656D2E4E65742E536F636B65747300546370436C69656E740061757468656E746963617465002E63746F72007365727665725365637265740053656E644D6573736167650053797374656D2E53656375726974792E43727970746F6772617068792E58353039436572746966696361746573005835303943657274696669636174650058353039436861696E0053797374656D2E4E65742E53656375726974790053736C506F6C6963794572726F72730056616C696461746553657276657243657274696669636174650053797374656D2E53656375726974792E43727970746F6772617068790052616E646F6D4E756D62657247656E657261746F720072616E646F6D0073656C664368616C6C656E6765007365637265740067657453656C664368616C6C656E676500676574526573706F6E736500636C69656E740070617373776F726400536572766572497000536572766572506F7274004D6573736167650073656E64657200636572746966696361746500636861696E0073736C506F6C6963794572726F72730072656D6F74654368616C6C656E67650072656D6F7465526573706F6E73650053797374656D2E5265666C656374696F6E00417373656D626C795469746C6541747472696275746500417373656D626C794465736372697074696F6E41747472696275746500417373656D626C79436F6E66696775726174696F6E41747472696275746500417373656D626C79436F6D70616E7941747472696275746500417373656D626C7950726F6475637441747472696275746500417373656D626C79436F7079726967687441747472696275746500417373656D626C7954726164656D61726B41747472696275746500417373656D626C7943756C747572654174747269627574650053797374656D2E52756E74696D652E496E7465726F70536572766963657300436F6D56697369626C65417474726962757465004775696441747472696275746500417373656D626C7956657273696F6E41747472696275746500417373656D626C7946696C6556657273696F6E4174747269627574650053797374656D2E446961676E6F73746963730044656275676761626C6541747472696275746500446562756767696E674D6F6465730053797374656D2E52756E74696D652E436F6D70696C6572536572766963657300436F6D70696C6174696F6E52656C61786174696F6E734174747269627574650052756E74696D65436F6D7061746962696C697479417474726962757465003C3E635F5F446973706C6179436C617373360072656D6F74654368616C6C656E67655374720072656D6F7465526573706F6E7365537472003C61757468656E7469636174653E625F5F31003C61757468656E7469636174653E625F5F330078003C61757468656E7469636174653E625F5F300053797374656D2E436F72650046756E636032004353243C3E395F5F436163686564416E6F6E796D6F75734D6574686F6444656C65676174653400436F6D70696C657247656E657261746564417474726962757465003C61757468656E7469636174653E625F5F32004353243C3E395F5F436163686564416E6F6E796D6F75734D6574686F6444656C65676174653500537472696E6700537562737472696E6700436F6E7665727400546F42797465004E6574776F726B53747265616D0047657453747265616D004279746500466F726D617400436F6E6361740053797374656D2E54657874004153434949456E636F64696E6700456E636F64696E670047657442797465730053797374656D2E494F0053747265616D00577269746500466C7573680052656164006765745F5554463800476574537472696E67006765745F4C656E6774680053797374656D2E4C696E7100456E756D657261626C650053797374656D2E436F6C6C656374696F6E732E47656E657269630049456E756D657261626C6560310052616E67650057686572650053656C65637400546F417272617900456D707479004368617200526561644279746500436F6E7461696E7300436F6E6E6563740049446973706F7361626C6500446973706F736500457863657074696F6E0058353039436861696E537461747573006765745F436861696E537461747573006765745F5375626A656374006765745F497373756572006F705F457175616C6974790058353039436861696E537461747573466C616773006765745F537461747573002E6363746F720055544638456E636F64696E67004372656174650042756666657200417272617900426C6F636B436F7079005348413531324D616E616765640048617368416C676F726974686D00436F6D70757465486173680053657175656E6365457175616C0000002941007500740068004300680061006C006C0065006E00670065005300650072007600650072002000000D7B0030003A00780032007D0000030A0000094E004F004B000A00003941007500740068004300680061006C006C0065006E006700650052006500730070006F006E0073006500530065007200760065007200200000074E004F004B000080C94F002C0021007B003C007000260029004C00230040002A007C005D007B0034005D002E007E005E0078003A003100290070007D003E00560055002200390031003A0027005400700044002A0026005B00400076002B0023006D00250058007C003B007B00230038005F003B00380058002500690062005B006F00480031002F00670022002E002E007C0020005E00680028007B00280074005E00430038007D005F00370025007D002F002D00770023005A003B007B003B003800580050005E00250048002300440001F6EFDDE77B9D3546A78B6FC7744C07F30008B77A5C561934E0890700020212091D050320000103061D05060003010E080E0A0004021C120D1211111503061219052001011D050420001D050620011D051D05072002021D051D05042001010E0420010102052001011151042001010802060E04200105080400010208070615125D02080204010000000520020E0808050002050E08042000126D0500020E0E1C0500020E0E0E0520011D050E072003011D050808072003081D05080804000012790720030E1D050808032000080A000215128085010808080615125D020802052002011C181810010215128085011E0015128085011E0015125D021E0002030A01080615125D0208051910020215128085011E0115128085011E0015125D021E001E01040A0208050D1001011D1E0015128085011E00030A01050500020E1C1C042001020E280717127D12101D050E0512751D051D051D051D051D051D051D051D050E05080E12141D05081D0508052002010E080B070512090E127D12751D050620001D1180950320000E050002020E0E0520001180990B0704118095021D118095080300000104000012190C0005011280A5081280A508080707021D051280A9121001020215128085011E0015128085011E000907031D051280A91D051201000D506F6C69637957617463686572000005010000000017010012436F7079726967687420C2A920203230313200002901002461306636636166372D343733362D346531652D393639642D33343163326139306236326400000C010007312E302E302E3000000801000200000000000801000800000000001E01000100540216577261704E6F6E457863657074696F6E5468726F7773010000000000562C725300000000020000009E0000009C3600009C18000052534453F704DA06F4B8274C95C4E7150AAC45E401000000433A5C55736572735C52656761746569726F5C44726F70626F785C55415C55415F414E4F5F355C4469737365727461C3A7C3A36F5C50726F6A656374735C50726F6A656374735C444143415C506F6C696379576174636865725C506F6C696379576174636865725C6F626A5C52656C656173655C506F6C696379576174636865722E7064620000006437000000000000000000007E37000000200000000000000000000000000000000000000000000070370000000000000000000000005F436F72446C6C4D61696E006D73636F7265652E646C6C0000000000FF250020400000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000100100000001800008000000000000000000000000000000100010000003000008000000000000000000000000000000100000000004800000058400000D00200000000000000000000D00234000000560053005F00560045005200530049004F004E005F0049004E0046004F0000000000BD04EFFE00000100000001000000000000000100000000003F000000000000000400000002000000000000000000000000000000440000000100560061007200460069006C00650049006E0066006F00000000002400040000005400720061006E0073006C006100740069006F006E00000000000000B00430020000010053007400720069006E006700460069006C00650049006E0066006F0000000C020000010030003000300030003000340062003000000044000E000100460069006C0065004400650073006300720069007000740069006F006E000000000050006F006C0069006300790057006100740063006800650072000000300008000100460069006C006500560065007200730069006F006E000000000031002E0030002E0030002E003000000044001200010049006E007400650072006E0061006C004E0061006D006500000050006F006C0069006300790057006100740063006800650072002E0064006C006C0000004800120001004C006500670061006C0043006F007000790072006900670068007400000043006F0070007900720069006700680074002000A90020002000320030003100320000004C00120001004F0072006900670069006E0061006C00460069006C0065006E0061006D006500000050006F006C0069006300790057006100740063006800650072002E0064006C006C0000003C000E000100500072006F0064007500630074004E0061006D0065000000000050006F006C0069006300790057006100740063006800650072000000340008000100500072006F006400750063007400560065007200730069006F006E00000031002E0030002E0030002E003000000038000800010041007300730065006D0062006C0079002000560065007200730069006F006E00000031002E0030002E0030002E0030000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000003000000C000000903700000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
WITH PERMISSION_SET = UNSAFE

/****** ALTERNATIVE IF YOU NEED TO USE THE .dll CREATED BY THE POLICY WATCHER PROJECT ******/
--CREATE ASSEMBLY PolicyWatcher
--AUTHORIZATION dbo 
--FROM 'C:\Users\OMP\Documents\OMP\Work\Projects\DACA\PolicyWatcher\PolicyWatcher\bin\Release\PolicyWatcher.dll' 
--WITH PERMISSION_SET = UNSAFE

GO
/****** Object:  Schema [_remote]    Script Date: 07-06-2014 23:56:25 ******/
CREATE SCHEMA [_remote]
GO
/****** Object:  StoredProcedure [_remote].[RemoteCall]    Script Date: 07-06-2014 23:56:25 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO

CREATE PROCEDURE [_remote].[RemoteCall]
	@SessionID INT,
	@QuerySRID INT,
	@Params NVARCHAR(MAX) = ''
AS 
BEGIN
	DECLARE @i INT
	DECLARE @QueryRID INT
	DECLARE @QueryID INT
	DECLARE @Query NVARCHAR(MAX)
	DECLARE @NumParams INT
	DECLARE @ParamName NVARCHAR(32)
	DECLARE @ParamType NVARCHAR(32)
	DECLARE @ParamValue NVARCHAR(32)
	DECLARE @ParamsDef NVARCHAR(MAX)

	-- *** GET QUERYRID ***
	SELECT @QueryRID = SQ.[QueryRID]
	FROM _remote.[SessionQueries] as SQ
	WHERE SQ.[SessionID] = @SessionID AND SQ.[QuerySRID] = @QuerySRID

	-- *** GET QUERY TO EXECUTE ***
	SELECT @Query = Q.[Query], @QueryID = Q.[_ID]
	FROM _remote.[Queries] as Q
	WHERE Q.[RID] = @QueryRID
	
	-- *** PARAM DEFINITIONS (ParamName, ParamType) ***
	-- Get the number of parameters
	SET @NumParams = (
		SELECT COUNT(*)
		FROM _remote.Operands as O
		WHERE O.RefID = @QueryID
	)

	-- Initialize the parameter definition section with ", N'"
	SET @ParamsDef = ', N'''
	SET @i = 1

	-- For each parameter, add its name and type to the variable
	WHILE @i <= @NumParams
	BEGIN
		SELECT @ParamName = O.[Name], @ParamType = O.[Type]
		FROM _remote.Operands as O
		WHERE O.[RefID] = @QueryID AND O.[Position] = @i

		SET @ParamsDef = @ParamsDef + (@ParamName + ' ' + @ParamType)
		IF @i < @NumParams SET @ParamsDef = @ParamsDef + ', '

		SET @i = @i + 1
	END

	-- Add a last ' to the definitions, to close the ", N'" earlier
	SET @ParamsDef = @ParamsDef + ''''

	-- Prepare the parameters, if they exist a ',' is added before them for the final query
	IF @Params <> '' SET @Params = ', ' + @Params

	-- EXECUTE the query, the result is automatically returned.
	EXEC('EXEC sp_executesql N''' + @Query + '''' + @ParamsDef + @Params)
END


GO
/****** Object:  StoredProcedure [dbo].[SendMessage]    Script Date: 07-06-2014 23:56:25 ******/
SET ANSI_NULLS OFF
GO
SET QUOTED_IDENTIFIER OFF
GO
CREATE PROCEDURE [dbo].[SendMessage]
	@serverip [nvarchar](50),
	@serverPort [int],
	@message [nvarchar](max)
WITH EXECUTE AS CALLER
AS
EXTERNAL NAME [PolicyWatcher].[PolicyWatcher.PolicyWatcher].[SendMessage]
GO
/****** Object:  Table [_remote].[Operands]    Script Date: 07-06-2014 23:56:25 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
CREATE TABLE [_remote].[Operands](
	[RefID] [int] NOT NULL,
	[Position] [int] NOT NULL,
	[Name] [nvarchar](32) NOT NULL,
	[Type] [nvarchar](32) NOT NULL,
 CONSTRAINT [OP_PK] PRIMARY KEY CLUSTERED 
(
	[RefID] ASC,
	[Position] ASC
)WITH (PAD_INDEX = OFF, STATISTICS_NORECOMPUTE = OFF, IGNORE_DUP_KEY = OFF, ALLOW_ROW_LOCKS = ON, ALLOW_PAGE_LOCKS = ON) ON [PRIMARY]
) ON [PRIMARY]

GO
/****** Object:  Table [_remote].[Queries]    Script Date: 07-06-2014 23:56:25 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
CREATE TABLE [_remote].[Queries](
	[_ID] [int] IDENTITY(1,1) NOT NULL,
	[RID] [int] NOT NULL,
	[QueryReference] [nvarchar](100) NOT NULL,
	[Query] [nvarchar](max) NOT NULL,
PRIMARY KEY CLUSTERED 
(
	[_ID] ASC
)WITH (PAD_INDEX = OFF, STATISTICS_NORECOMPUTE = OFF, IGNORE_DUP_KEY = OFF, ALLOW_ROW_LOCKS = ON, ALLOW_PAGE_LOCKS = ON) ON [PRIMARY],
UNIQUE NONCLUSTERED 
(
	[RID] ASC
)WITH (PAD_INDEX = OFF, STATISTICS_NORECOMPUTE = OFF, IGNORE_DUP_KEY = OFF, ALLOW_ROW_LOCKS = ON, ALLOW_PAGE_LOCKS = ON) ON [PRIMARY]
) ON [PRIMARY] TEXTIMAGE_ON [PRIMARY]

GO
/****** Object:  Table [_remote].[SessionQueries]    Script Date: 07-06-2014 23:56:25 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
CREATE TABLE [_remote].[SessionQueries](
	[SessionID] [int] NOT NULL,
	[QuerySRID] [int] NOT NULL,
	[QueryRID] [int] NOT NULL,
 CONSTRAINT [PK_SQ] PRIMARY KEY CLUSTERED 
(
	[SessionID] ASC,
	[QuerySRID] ASC
)WITH (PAD_INDEX = OFF, STATISTICS_NORECOMPUTE = OFF, IGNORE_DUP_KEY = OFF, ALLOW_ROW_LOCKS = ON, ALLOW_PAGE_LOCKS = ON) ON [PRIMARY]
) ON [PRIMARY]

GO
/****** Object:  Table [dbo].[App_Application]    Script Date: 07-06-2014 23:56:25 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
SET ANSI_PADDING ON
GO
CREATE TABLE [dbo].[App_Application](
	[App_id] [int] IDENTITY(1,1) NOT NULL,
	[App_reference] [nvarchar](50) NOT NULL,
	[App_description] [nvarchar](max) NULL,
	[App_BusinessSchemas] [varbinary](max) NOT NULL,
 CONSTRAINT [PK_App_Application] PRIMARY KEY CLUSTERED 
(
	[App_id] ASC
)WITH (PAD_INDEX = OFF, STATISTICS_NORECOMPUTE = OFF, IGNORE_DUP_KEY = OFF, ALLOW_ROW_LOCKS = ON, ALLOW_PAGE_LOCKS = ON) ON [PRIMARY],
 CONSTRAINT [U5] UNIQUE NONCLUSTERED 
(
	[App_reference] ASC
)WITH (PAD_INDEX = OFF, STATISTICS_NORECOMPUTE = OFF, IGNORE_DUP_KEY = OFF, ALLOW_ROW_LOCKS = ON, ALLOW_PAGE_LOCKS = ON) ON [PRIMARY]
) ON [PRIMARY] TEXTIMAGE_ON [PRIMARY]

GO
SET ANSI_PADDING OFF
GO
/****** Object:  Table [dbo].[AppRol]    Script Date: 07-06-2014 23:56:25 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
CREATE TABLE [dbo].[AppRol](
	[AppRol_id] [int] IDENTITY(1,1) NOT NULL,
	[AppRolApp_id] [int] NOT NULL,
	[AppRolRol_id] [int] NOT NULL,
 CONSTRAINT [PK_AppRol] PRIMARY KEY CLUSTERED 
(
	[AppRol_id] ASC
)WITH (PAD_INDEX = OFF, STATISTICS_NORECOMPUTE = OFF, IGNORE_DUP_KEY = OFF, ALLOW_ROW_LOCKS = ON, ALLOW_PAGE_LOCKS = ON) ON [PRIMARY]
) ON [PRIMARY]

GO
/****** Object:  Table [dbo].[Aut_Authorization]    Script Date: 07-06-2014 23:56:25 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
CREATE TABLE [dbo].[Aut_Authorization](
	[Aut_id] [int] IDENTITY(1,1) NOT NULL,
	[Aut_code] [int] NOT NULL,
	[AutSubApp_id] [int] NOT NULL,
	[AutRol_id] [int] NOT NULL,
 CONSTRAINT [PK_Aut_Authorization] PRIMARY KEY CLUSTERED 
(
	[Aut_id] ASC
)WITH (PAD_INDEX = OFF, STATISTICS_NORECOMPUTE = OFF, IGNORE_DUP_KEY = OFF, ALLOW_ROW_LOCKS = ON, ALLOW_PAGE_LOCKS = ON) ON [PRIMARY],
 CONSTRAINT [UAUT] UNIQUE NONCLUSTERED 
(
	[AutSubApp_id] ASC,
	[AutRol_id] ASC
)WITH (PAD_INDEX = OFF, STATISTICS_NORECOMPUTE = OFF, IGNORE_DUP_KEY = OFF, ALLOW_ROW_LOCKS = ON, ALLOW_PAGE_LOCKS = ON) ON [PRIMARY]
) ON [PRIMARY]

GO
/****** Object:  Table [dbo].[BSSeqPos]    Script Date: 07-06-2014 23:56:25 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
CREATE TABLE [dbo].[BSSeqPos](
	[SeqID] [int] NOT NULL,
	[SeqPos] [int] NOT NULL,
	[RefBusID] [int] NULL,
 CONSTRAINT [BSSeqPos_PK] PRIMARY KEY CLUSTERED 
(
	[SeqID] ASC,
	[SeqPos] ASC
)WITH (PAD_INDEX = OFF, STATISTICS_NORECOMPUTE = OFF, IGNORE_DUP_KEY = OFF, ALLOW_ROW_LOCKS = ON, ALLOW_PAGE_LOCKS = ON) ON [PRIMARY]
) ON [PRIMARY]

GO
/****** Object:  Table [dbo].[BSSeqRol]    Script Date: 07-06-2014 23:56:25 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
CREATE TABLE [dbo].[BSSeqRol](
	[SeqID] [int] NOT NULL,
	[RefRolID] [int] NOT NULL,
 CONSTRAINT [BSSeqRol_PK] PRIMARY KEY CLUSTERED 
(
	[SeqID] ASC,
	[RefRolID] ASC
)WITH (PAD_INDEX = OFF, STATISTICS_NORECOMPUTE = OFF, IGNORE_DUP_KEY = OFF, ALLOW_ROW_LOCKS = ON, ALLOW_PAGE_LOCKS = ON) ON [PRIMARY]
) ON [PRIMARY]

GO
/****** Object:  Table [dbo].[Bus_BusinessSchema]    Script Date: 07-06-2014 23:56:25 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
CREATE TABLE [dbo].[Bus_BusinessSchema](
	[Bus_id] [int] IDENTITY(1,1) NOT NULL,
	[Bus_url] [nvarchar](max) NOT NULL,
	[Bus_description] [nvarchar](max) NULL,
 CONSTRAINT [PK_Bus_BusinessSchema] PRIMARY KEY CLUSTERED 
(
	[Bus_id] ASC
)WITH (PAD_INDEX = OFF, STATISTICS_NORECOMPUTE = OFF, IGNORE_DUP_KEY = OFF, ALLOW_ROW_LOCKS = ON, ALLOW_PAGE_LOCKS = ON) ON [PRIMARY]
) ON [PRIMARY] TEXTIMAGE_ON [PRIMARY]

GO
/****** Object:  Table [dbo].[BusCrd]    Script Date: 07-06-2014 23:56:25 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
CREATE TABLE [dbo].[BusCrd](
	[BusCrud_id] [int] IDENTITY(1,1) NOT NULL,
	[BusCrdBus_id] [int] NOT NULL,
	[BusCrdCrd_id] [int] NOT NULL,
 CONSTRAINT [PK_BusCrd] PRIMARY KEY CLUSTERED 
(
	[BusCrud_id] ASC
)WITH (PAD_INDEX = OFF, STATISTICS_NORECOMPUTE = OFF, IGNORE_DUP_KEY = OFF, ALLOW_ROW_LOCKS = ON, ALLOW_PAGE_LOCKS = ON) ON [PRIMARY]
) ON [PRIMARY]

GO
/****** Object:  Table [dbo].[ControlInfo]    Script Date: 07-06-2014 23:56:25 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
SET ANSI_PADDING OFF
GO
CREATE TABLE [dbo].[ControlInfo](
	[_ID] [int] IDENTITY(1,1) NOT NULL,
	[key] [varchar](16) NOT NULL,
	[value] [bit] NULL,
PRIMARY KEY CLUSTERED 
(
	[_ID] ASC
)WITH (PAD_INDEX = OFF, STATISTICS_NORECOMPUTE = OFF, IGNORE_DUP_KEY = OFF, ALLOW_ROW_LOCKS = ON, ALLOW_PAGE_LOCKS = ON) ON [PRIMARY],
UNIQUE NONCLUSTERED 
(
	[key] ASC
)WITH (PAD_INDEX = OFF, STATISTICS_NORECOMPUTE = OFF, IGNORE_DUP_KEY = OFF, ALLOW_ROW_LOCKS = ON, ALLOW_PAGE_LOCKS = ON) ON [PRIMARY]
) ON [PRIMARY]

GO
SET ANSI_PADDING OFF
GO
/****** Object:  Table [dbo].[Crd_Crud]    Script Date: 07-06-2014 23:56:25 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
CREATE TABLE [dbo].[Crd_Crud](
	[Crd_id] [int] IDENTITY(1,1) NOT NULL,
	[Crd_crud] [nvarchar](1024) NULL,
	[Crd_Reference] [nvarchar](50) NULL,
 CONSTRAINT [PK_Crd_Crud] PRIMARY KEY CLUSTERED 
(
	[Crd_id] ASC
)WITH (PAD_INDEX = OFF, STATISTICS_NORECOMPUTE = OFF, IGNORE_DUP_KEY = OFF, ALLOW_ROW_LOCKS = ON, ALLOW_PAGE_LOCKS = ON) ON [PRIMARY]
) ON [PRIMARY]

GO
/****** Object:  Table [dbo].[Del_Delegation]    Script Date: 07-06-2014 23:56:25 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
CREATE TABLE [dbo].[Del_Delegation](
	[Del_id] [int] IDENTITY(1,1) NOT NULL,
	[DelSubApp_id] [int] NOT NULL,
	[DelAppRol_id] [int] NOT NULL,
 CONSTRAINT [PK_Del_Delegation] PRIMARY KEY CLUSTERED 
(
	[Del_id] ASC
)WITH (PAD_INDEX = OFF, STATISTICS_NORECOMPUTE = OFF, IGNORE_DUP_KEY = OFF, ALLOW_ROW_LOCKS = ON, ALLOW_PAGE_LOCKS = ON) ON [PRIMARY],
 CONSTRAINT [UDEL] UNIQUE NONCLUSTERED 
(
	[DelSubApp_id] ASC,
	[DelAppRol_id] ASC
)WITH (PAD_INDEX = OFF, STATISTICS_NORECOMPUTE = OFF, IGNORE_DUP_KEY = OFF, ALLOW_ROW_LOCKS = ON, ALLOW_PAGE_LOCKS = ON) ON [PRIMARY]
) ON [PRIMARY]

GO
/****** Object:  Table [dbo].[RevokeList]    Script Date: 07-06-2014 23:56:25 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
CREATE TABLE [dbo].[RevokeList](
	[RefSeqID] [int] NOT NULL,
	[RefSeqPos] [int] NOT NULL,
	[RefBusID] [int] NOT NULL,
 CONSTRAINT [RevokeList_PK] PRIMARY KEY CLUSTERED 
(
	[RefSeqID] ASC,
	[RefSeqPos] ASC,
	[RefBusID] ASC
)WITH (PAD_INDEX = OFF, STATISTICS_NORECOMPUTE = OFF, IGNORE_DUP_KEY = OFF, ALLOW_ROW_LOCKS = ON, ALLOW_PAGE_LOCKS = ON) ON [PRIMARY]
) ON [PRIMARY]

GO
/****** Object:  Table [dbo].[Rol_Role]    Script Date: 07-06-2014 23:56:25 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
CREATE TABLE [dbo].[Rol_Role](
	[Rol_id] [int] IDENTITY(1,1) NOT NULL,
	[Rol_reference] [nvarchar](50) NOT NULL,
	[Rol_description] [nchar](10) NULL,
	[RolRol_id] [int] NULL,
	[Rol_Orq] [bit] NOT NULL,
 CONSTRAINT [PK_Rol_Role] PRIMARY KEY CLUSTERED 
(
	[Rol_id] ASC
)WITH (PAD_INDEX = OFF, STATISTICS_NORECOMPUTE = OFF, IGNORE_DUP_KEY = OFF, ALLOW_ROW_LOCKS = ON, ALLOW_PAGE_LOCKS = ON) ON [PRIMARY],
 CONSTRAINT [U4] UNIQUE NONCLUSTERED 
(
	[Rol_reference] ASC
)WITH (PAD_INDEX = OFF, STATISTICS_NORECOMPUTE = OFF, IGNORE_DUP_KEY = OFF, ALLOW_ROW_LOCKS = ON, ALLOW_PAGE_LOCKS = ON) ON [PRIMARY]
) ON [PRIMARY]

GO
/****** Object:  Table [dbo].[RolBus]    Script Date: 07-06-2014 23:56:25 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
CREATE TABLE [dbo].[RolBus](
	[RolBus_id] [int] IDENTITY(1,1) NOT NULL,
	[RolBusRol_id] [int] NOT NULL,
	[RolBusBus_id] [int] NOT NULL,
 CONSTRAINT [PK_RolBus] PRIMARY KEY CLUSTERED 
(
	[RolBus_id] ASC
)WITH (PAD_INDEX = OFF, STATISTICS_NORECOMPUTE = OFF, IGNORE_DUP_KEY = OFF, ALLOW_ROW_LOCKS = ON, ALLOW_PAGE_LOCKS = ON) ON [PRIMARY]
) ON [PRIMARY]

GO
/****** Object:  Table [dbo].[ServerInfo]    Script Date: 07-06-2014 23:56:25 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
CREATE TABLE [dbo].[ServerInfo](
	[ServerIP] [nvarchar](50) NOT NULL,
	[ServerPort] [int] NOT NULL
) ON [PRIMARY]

GO
/****** Object:  Table [dbo].[Ses_Session]    Script Date: 07-06-2014 23:56:25 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
CREATE TABLE [dbo].[Ses_Session](
	[Ses_id] [int] NOT NULL,
	[SesSubApp_id] [int] NULL,
	[Ses_clientIP] [nvarchar](16) NOT NULL,
	[Ses_clientPort] [int] NOT NULL,
PRIMARY KEY CLUSTERED 
(
	[Ses_id] ASC
)WITH (PAD_INDEX = OFF, STATISTICS_NORECOMPUTE = OFF, IGNORE_DUP_KEY = OFF, ALLOW_ROW_LOCKS = ON, ALLOW_PAGE_LOCKS = ON) ON [PRIMARY],
 CONSTRAINT [UQ_Session] UNIQUE NONCLUSTERED 
(
	[SesSubApp_id] ASC,
	[Ses_clientIP] ASC,
	[Ses_clientPort] ASC
)WITH (PAD_INDEX = OFF, STATISTICS_NORECOMPUTE = OFF, IGNORE_DUP_KEY = OFF, ALLOW_ROW_LOCKS = ON, ALLOW_PAGE_LOCKS = ON) ON [PRIMARY]
) ON [PRIMARY]

GO
/****** Object:  Table [dbo].[Sub_Subject]    Script Date: 07-06-2014 23:56:25 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
CREATE TABLE [dbo].[Sub_Subject](
	[Sub_id] [int] IDENTITY(1,1) NOT NULL,
	[Sub_username] [nvarchar](50) NOT NULL,
	[Sub_password] [nvarchar](130) NOT NULL,
	[Sub_salt] [nvarchar](70) NOT NULL,
	[Sub_BI] [nvarchar](10) NULL,
 CONSTRAINT [PK_Sub_Subject] PRIMARY KEY CLUSTERED 
(
	[Sub_id] ASC
)WITH (PAD_INDEX = OFF, STATISTICS_NORECOMPUTE = OFF, IGNORE_DUP_KEY = OFF, ALLOW_ROW_LOCKS = ON, ALLOW_PAGE_LOCKS = ON) ON [PRIMARY],
 CONSTRAINT [U6] UNIQUE NONCLUSTERED 
(
	[Sub_username] ASC
)WITH (PAD_INDEX = OFF, STATISTICS_NORECOMPUTE = OFF, IGNORE_DUP_KEY = OFF, ALLOW_ROW_LOCKS = ON, ALLOW_PAGE_LOCKS = ON) ON [PRIMARY]
) ON [PRIMARY]

GO
/****** Object:  Table [dbo].[SubApp]    Script Date: 07-06-2014 23:56:25 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
CREATE TABLE [dbo].[SubApp](
	[SubApp_id] [int] IDENTITY(1,1) NOT NULL,
	[SubAppSub_id] [int] NOT NULL,
	[SubAppApp_id] [int] NOT NULL,
 CONSTRAINT [PK_SubApp] PRIMARY KEY CLUSTERED 
(
	[SubApp_id] ASC
)WITH (PAD_INDEX = OFF, STATISTICS_NORECOMPUTE = OFF, IGNORE_DUP_KEY = OFF, ALLOW_ROW_LOCKS = ON, ALLOW_PAGE_LOCKS = ON) ON [PRIMARY]
) ON [PRIMARY]

GO
ALTER TABLE [dbo].[ControlInfo] ADD  DEFAULT ((1)) FOR [value]
GO
ALTER TABLE [dbo].[Rol_Role] ADD  DEFAULT ((1)) FOR [Rol_Orq]
GO
ALTER TABLE [_remote].[Operands]  WITH CHECK ADD FOREIGN KEY([RefID])
REFERENCES [_remote].[Queries] ([_ID])
GO
ALTER TABLE [dbo].[AppRol]  WITH CHECK ADD  CONSTRAINT [FK_AppRol_App_Application] FOREIGN KEY([AppRolApp_id])
REFERENCES [dbo].[App_Application] ([App_id])
GO
ALTER TABLE [dbo].[AppRol] CHECK CONSTRAINT [FK_AppRol_App_Application]
GO
ALTER TABLE [dbo].[AppRol]  WITH CHECK ADD  CONSTRAINT [FK_AppRol_Rol_Role] FOREIGN KEY([AppRolRol_id])
REFERENCES [dbo].[Rol_Role] ([Rol_id])
GO
ALTER TABLE [dbo].[AppRol] CHECK CONSTRAINT [FK_AppRol_Rol_Role]
GO
ALTER TABLE [dbo].[Aut_Authorization]  WITH CHECK ADD  CONSTRAINT [FK_Aut_Authorization_Rol_Role] FOREIGN KEY([AutRol_id])
REFERENCES [dbo].[Rol_Role] ([Rol_id])
GO
ALTER TABLE [dbo].[Aut_Authorization] CHECK CONSTRAINT [FK_Aut_Authorization_Rol_Role]
GO
ALTER TABLE [dbo].[Aut_Authorization]  WITH CHECK ADD  CONSTRAINT [FK_Aut_Authorization_SubApp] FOREIGN KEY([AutSubApp_id])
REFERENCES [dbo].[SubApp] ([SubApp_id])
GO
ALTER TABLE [dbo].[Aut_Authorization] CHECK CONSTRAINT [FK_Aut_Authorization_SubApp]
GO
ALTER TABLE [dbo].[BSSeqPos]  WITH CHECK ADD FOREIGN KEY([RefBusID])
REFERENCES [dbo].[Bus_BusinessSchema] ([Bus_id])
GO
ALTER TABLE [dbo].[BSSeqRol]  WITH CHECK ADD FOREIGN KEY([RefRolID])
REFERENCES [dbo].[Rol_Role] ([Rol_id])
GO
ALTER TABLE [dbo].[BusCrd]  WITH CHECK ADD  CONSTRAINT [FK_BusCrd_Bus_BusinessSchema] FOREIGN KEY([BusCrdBus_id])
REFERENCES [dbo].[Bus_BusinessSchema] ([Bus_id])
GO
ALTER TABLE [dbo].[BusCrd] CHECK CONSTRAINT [FK_BusCrd_Bus_BusinessSchema]
GO
ALTER TABLE [dbo].[BusCrd]  WITH CHECK ADD  CONSTRAINT [FK_BusCrd_Crd_Crud] FOREIGN KEY([BusCrdCrd_id])
REFERENCES [dbo].[Crd_Crud] ([Crd_id])
GO
ALTER TABLE [dbo].[BusCrd] CHECK CONSTRAINT [FK_BusCrd_Crd_Crud]
GO
ALTER TABLE [dbo].[Del_Delegation]  WITH CHECK ADD  CONSTRAINT [FK_Del_Delegation_AppRol] FOREIGN KEY([DelAppRol_id])
REFERENCES [dbo].[AppRol] ([AppRol_id])
GO
ALTER TABLE [dbo].[Del_Delegation] CHECK CONSTRAINT [FK_Del_Delegation_AppRol]
GO
ALTER TABLE [dbo].[Del_Delegation]  WITH CHECK ADD  CONSTRAINT [FK_Del_Delegation_SubApp] FOREIGN KEY([DelSubApp_id])
REFERENCES [dbo].[SubApp] ([SubApp_id])
GO
ALTER TABLE [dbo].[Del_Delegation] CHECK CONSTRAINT [FK_Del_Delegation_SubApp]
GO
ALTER TABLE [dbo].[RevokeList]  WITH CHECK ADD FOREIGN KEY([RefBusID])
REFERENCES [dbo].[Bus_BusinessSchema] ([Bus_id])
GO
ALTER TABLE [dbo].[RevokeList]  WITH CHECK ADD  CONSTRAINT [RevokeList_FK] FOREIGN KEY([RefSeqID], [RefSeqPos])
REFERENCES [dbo].[BSSeqPos] ([SeqID], [SeqPos])
GO
ALTER TABLE [dbo].[RevokeList] CHECK CONSTRAINT [RevokeList_FK]
GO
ALTER TABLE [dbo].[Rol_Role]  WITH CHECK ADD  CONSTRAINT [FK_Rol_Role_Rol_Role] FOREIGN KEY([RolRol_id])
REFERENCES [dbo].[Rol_Role] ([Rol_id])
GO
ALTER TABLE [dbo].[Rol_Role] CHECK CONSTRAINT [FK_Rol_Role_Rol_Role]
GO
ALTER TABLE [dbo].[RolBus]  WITH CHECK ADD  CONSTRAINT [FK_RolBus_Bus_BusinessSchema] FOREIGN KEY([RolBusBus_id])
REFERENCES [dbo].[Bus_BusinessSchema] ([Bus_id])
GO
ALTER TABLE [dbo].[RolBus] CHECK CONSTRAINT [FK_RolBus_Bus_BusinessSchema]
GO
ALTER TABLE [dbo].[RolBus]  WITH CHECK ADD  CONSTRAINT [FK_RolBus_Rol_Role] FOREIGN KEY([RolBusRol_id])
REFERENCES [dbo].[Rol_Role] ([Rol_id])
GO
ALTER TABLE [dbo].[RolBus] CHECK CONSTRAINT [FK_RolBus_Rol_Role]
GO
ALTER TABLE [dbo].[Ses_Session]  WITH CHECK ADD FOREIGN KEY([SesSubApp_id])
REFERENCES [dbo].[SubApp] ([SubApp_id])
GO
ALTER TABLE [dbo].[SubApp]  WITH CHECK ADD  CONSTRAINT [FK_SubApp_App_Application] FOREIGN KEY([SubAppApp_id])
REFERENCES [dbo].[App_Application] ([App_id])
GO
ALTER TABLE [dbo].[SubApp] CHECK CONSTRAINT [FK_SubApp_App_Application]
GO
ALTER TABLE [dbo].[SubApp]  WITH CHECK ADD  CONSTRAINT [FK_SubApp_Sub_Subject] FOREIGN KEY([SubAppSub_id])
REFERENCES [dbo].[Sub_Subject] ([Sub_id])
GO
ALTER TABLE [dbo].[SubApp] CHECK CONSTRAINT [FK_SubApp_Sub_Subject]
GO
USE [master]
GO
ALTER DATABASE [PolicyServer2] SET  READ_WRITE 
GO

INSERT INTO _remote.Queries(RID, QueryReference, Query)
VALUES(1, 'I_Orders_withCostumerID', 'INSERT INTO Northwind.dbo.Orders(CustomerID,EmployeeID,OrderDate,RequiredDate,ShippedDate,ShipVia,Freight,ShipName,ShipAddress,ShipCity,ShipRegion,ShipPostalCode,ShipCountry) VALUES (@CustomerID,@EmployeeID,@OrderDate,@RequiredDate,@ShippedDate,@ShipVia,@Freight,@ShipName,@ShipAddress,@ShipCity,@ShipRegion,@ShipPostalCode,@ShipCountry)')

GO

INSERT INTO _remote.Queries(RID, QueryReference, Query)
VALUES(2, 'S_Custumers_all', 'SELECT * FROM Northwind.dbo.Customers WHERE Country = ''''USA''''')

GO

INSERT INTO _remote.Queries(RID, QueryReference, Query)
VALUES(3, 'S_Orders_byShipCountry', 'SELECT * FROM Northwind.dbo.Orders WHERE CustomerId = @CustomerId and ShipCountry = @ShipCountry')

GO

INSERT INTO _remote.Queries(RID, QueryReference, Query)
VALUES(4, 'U_Orders_shipDestination', 'UPDATE Northwind.dbo.Orders SET ShipAddress = @ShippedAddress, ShipCity = @ShippedCity, ShipCountry = @ShippedCountry WHERE OrderID = @OrderID')

GO

INSERT INTO _remote.Operands(RefID, Position, Name, [Type])
VALUES (1, 1, '@CustomerID', 'nchar(5)')
INSERT INTO _remote.Operands(RefID, Position, Name, [Type])
VALUES (1, 2, '@EmployeeID', 'int')
INSERT INTO _remote.Operands(RefID, Position, Name, [Type])
VALUES (1, 3, '@OrderDate', 'datetime')
INSERT INTO _remote.Operands(RefID, Position, Name, [Type])
VALUES (1, 4, '@RequiredDate', 'datetime')
INSERT INTO _remote.Operands(RefID, Position, Name, [Type])
VALUES (1, 5, '@ShippedDate', 'datetime')
INSERT INTO _remote.Operands(RefID, Position, Name, [Type])
VALUES (1, 6, '@ShipVia', 'int')
INSERT INTO _remote.Operands(RefID, Position, Name, [Type])
VALUES (1, 7, '@Freight', 'money')
INSERT INTO _remote.Operands(RefID, Position, Name, [Type])
VALUES (1, 8, '@ShipName', 'nvarchar(40)')
INSERT INTO _remote.Operands(RefID, Position, Name, [Type])
VALUES (1, 9, '@ShipAddress', 'nvarchar(60)')
INSERT INTO _remote.Operands(RefID, Position, Name, [Type])
VALUES (1, 10, '@ShipCity', 'nvarchar(15)')
INSERT INTO _remote.Operands(RefID, Position, Name, [Type])
VALUES (1, 11, '@ShipRegion', 'nvarchar(15)')
INSERT INTO _remote.Operands(RefID, Position, Name, [Type])
VALUES (1, 12, '@ShipPostalCode', 'nvarchar(10)')
INSERT INTO _remote.Operands(RefID, Position, Name, [Type])
VALUES (1, 13, '@ShipCountry', 'nvarchar(15)')

GO

INSERT INTO _remote.Operands(RefID, Position, Name, [Type])
VALUES (3, 1, '@CustomerID', 'nchar(5)')
INSERT INTO _remote.Operands(RefID, Position, Name, [Type])
VALUES (3, 2, '@ShipCountry', 'nvarchar(15)')

GO

INSERT INTO _remote.Operands(RefID, Position, Name, [Type])
VALUES (4, 1, '@OrderID', 'int')
INSERT INTO _remote.Operands(RefID, Position, Name, [Type])
VALUES (4, 2, '@ShippedAddress', 'nvarchar(60)')
INSERT INTO _remote.Operands(RefID, Position, Name, [Type])
VALUES (4, 3, '@ShippedCountry', 'nvarchar(15)')
INSERT INTO _remote.Operands(RefID, Position, Name, [Type])
VALUES (4, 4, '@ShippedCity', 'nvarchar(15)')
